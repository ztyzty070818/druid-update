dateStr=`date +"%Y-%m-%d" -d "-1day"`
todayStr=`date +"%Y-%m-%d"`
sqoop import -D mapred.job.queue.name=root.default --connect jdbc:mysql://10.29.254.109:3306/platform_admin?characterEncoding=UTF-8 --username platform_admin --password 'gob75vuR0KyzI#al' --target-dir=/user/root/warehouse/fuli_caution_add \
--hive-import -hive-drop-import-delims --hive-table fuli_caution --hive-partition-key day --hive-partition-value $dateStr-add -m 1 --query \
"SELECT open_caution_info.id AS open_caution_info__id, open_caution_info.service_id AS open_caution_info__service_id, open_caution_info.money AS open_caution_info__money, open_caution_info.bill_id AS open_caution_info__bill_id, open_caution_info.bill_create_time AS open_caution_info__bill_create_time \
	, open_caution_info.bill_status AS open_caution_info__bill_status, open_caution_info.bill_pay_time AS open_caution_info__bill_pay_time, open_caution_info.create_time AS open_caution_info__create_time, open_caution_info.status AS open_caution_info__status, open_caution_info.pay_time AS open_caution_info__pay_time \
	, open_caution_info.create_uid AS open_caution_info__create_uid, open_caution_info.money_type AS open_caution_info__money_type, open_caution_info.money_pic AS open_caution_info__money_pic, open_caution_info.open_id AS open_caution_info__open_id, open_caution_info.remarks AS open_caution_info__remarks \
	, community_service.id AS community_service__id, community_service.title AS community_service__title, community_service.png AS community_service__png, community_service.disable_png AS community_service__disable_png, community_service.reorder AS community_service__reorder \
	, community_service.clause AS community_service__clause, community_service.type AS community_service__type, community_service.is_account AS community_service__is_account, community_service.link AS community_service__link, community_service.provide_type AS community_service__provide_type \
	, community_service.status AS community_service__status, community_service.app_id AS community_service__app_id, community_service.description AS community_service__description, community_service.audit_comment AS community_service__audit_comment, community_service.create_time AS community_service__create_time \
	, community_service.update_time AS community_service__update_time, community_service.audit_time AS community_service__audit_time, community_service.category_id AS community_service__category_id, community_service.is_need_hardware AS community_service__is_need_hardware, community_service.target_month_turnover AS community_service__target_month_turnover \
	, community_service.paid_caution_money AS community_service__paid_caution_money, community_service.caution_money_status AS community_service__caution_money_status, community_service.ground_mode AS community_service__ground_mode, community_service.merchant_id AS community_service__merchant_id, community_service.account_id AS community_service__account_id \
	, community_service.audit_status AS community_service__audit_status, community_service.clause_id AS community_service__clause_id, community_service.app_secret AS community_service__app_secret, community_service.receivable_caution_money AS community_service__receivable_caution_money, community_service.recommend_level AS community_service__recommend_level \
	, community_service.caution_money_type AS community_service__caution_money_type, community_service.caution_money_pic AS community_service__caution_money_pic, community_service.remark AS community_service__remark, community_service.caution_bill_id AS community_service__caution_bill_id, community_service.commission_rate AS community_service__commission_rate \
	, community_service.user_range AS community_service__user_range, community_service.ground_audit_status AS community_service__ground_audit_status, community_service.shot AS community_service__shot, community_service.account_receivable_project AS community_service__account_receivable_project, community_service.notify_url AS community_service__notify_url \
	, community_service.balance_receive_email AS community_service__balance_receive_email, community_service.under_reason AS community_service__under_reason, community_service.ground_time AS community_service__ground_time, community_service.max_ios_version AS community_service__max_ios_version, community_service.min_ios_version AS community_service__min_ios_version \
	, community_service.max_andoird_version AS community_service__max_andoird_version, community_service.min_andoird_version AS community_service__min_andoird_version, community_service.service_need AS community_service__service_need, open_merchant_info.id AS open_merchant_info__id, open_merchant_info.email AS open_merchant_info__email \
	, open_merchant_info.type AS open_merchant_info__type, open_merchant_info.title AS open_merchant_info__title, open_merchant_info.title_simple AS open_merchant_info__title_simple, open_merchant_info.introduction AS open_merchant_info__introduction, open_merchant_info.business_scope AS open_merchant_info__business_scope \
	, open_merchant_info.create_time AS open_merchant_info__create_time, open_merchant_info.update_time AS open_merchant_info__update_time, open_merchant_info.registration_number AS open_merchant_info__registration_number, open_merchant_info.business_license AS open_merchant_info__business_license, open_merchant_info.is_other_license AS open_merchant_info__is_other_license \
	, open_merchant_info.other_license AS open_merchant_info__other_license, open_merchant_info.target_month_turnover AS open_merchant_info__target_month_turnover, open_merchant_info.contact_person AS open_merchant_info__contact_person, open_merchant_info.contact_phone AS open_merchant_info__contact_phone, open_merchant_info.province_area_id AS open_merchant_info__province_area_id \
	, open_merchant_info.city_area_id AS open_merchant_info__city_area_id, open_merchant_info.area_id AS open_merchant_info__area_id, open_merchant_info.area_info AS open_merchant_info__area_info, open_merchant_info.status AS open_merchant_info__status, open_merchant_info.status_content AS open_merchant_info__status_content \
	, open_merchant_info.bank_title AS open_merchant_info__bank_title, open_merchant_info.bank_account_name AS open_merchant_info__bank_account_name, open_merchant_info.bank_account AS open_merchant_info__bank_account, open_merchant_info.id_number AS open_merchant_info__id_number, open_merchant_info.id_positive AS open_merchant_info__id_positive \
	, open_merchant_info.id_obverse AS open_merchant_info__id_obverse, open_merchant_info.platform_fee AS open_merchant_info__platform_fee, open_merchant_info.mch_id AS open_merchant_info__mch_id, open_merchant_info.account_id AS open_merchant_info__account_id, open_merchant_info.xfsj_status AS open_merchant_info__xfsj_status \
	, open_merchant_info.legal_name AS open_merchant_info__legal_name, open_merchant_info.legal_id_card AS open_merchant_info__legal_id_card, open_merchant_info.legal_id_positive AS open_merchant_info__legal_id_positive, open_merchant_info.legal_id_back AS open_merchant_info__legal_id_back, open_merchant_info.src_business AS open_merchant_info__src_business \
	, open_merchant_info.src_city AS open_merchant_info__src_city, open_merchant_info.is_mandatary AS open_merchant_info__is_mandatary, open_merchant_info.mandatary_name AS open_merchant_info__mandatary_name, open_merchant_info.mandatary_id_card AS open_merchant_info__mandatary_id_card, open_merchant_info.mandatary_id_positive AS open_merchant_info__mandatary_id_positive \
	, open_merchant_info.mandatary_id_back AS open_merchant_info__mandatary_id_back, open_merchant_info.mandatary_other AS open_merchant_info__mandatary_other, community_service_category.id AS community_service_category__id, community_service_category.name AS community_service_category__name, community_service_category.create_time AS community_service_category__create_time \
	, community_service_category.type AS community_service_category__type, community_service_category.sort AS community_service_category__sort, community_service_category.exposure AS community_service_category__exposure, community_service_category.pid AS community_service_category__pid, community_service_category.link AS community_service_category__link \
	, community_service_category.png AS community_service_category__png, community_service_category.community_fee AS community_service_category__community_fee, community_service_category.premium_num AS community_service_category__premium_num, community_service_category.valid_status AS community_service_category__valid_status, open_service_detail.service_id AS open_service_detail__service_id \
	, open_service_detail.develop_type AS open_service_detail__develop_type, open_service_detail.templete_name AS open_service_detail__templete_name, open_service_detail.templete_status AS open_service_detail__templete_status, open_service_detail.app_index_sort AS open_service_detail__app_index_sort, open_service_detail.app_cat_sort AS open_service_detail__app_cat_sort \
	, open_service_detail.rfchina_code AS open_service_detail__rfchina_code, open_service_detail.caution_refund_status AS open_service_detail__caution_refund_status, open_service_detail.caution_refund_reason AS open_service_detail__caution_refund_reason, open_service_detail.xfsj_status AS open_service_detail__xfsj_status, open_service_detail.category_second_type AS open_service_detail__category_second_type \
	, open_service_detail.protocol_url AS open_service_detail__protocol_url, open_service_detail.verify_role AS open_service_detail__verify_role \
FROM open_caution_info \
	LEFT JOIN community_service ON open_caution_info.service_id = community_service.id \
	LEFT JOIN open_merchant_info ON community_service.merchant_id = open_merchant_info.id \
	LEFT JOIN community_service_category ON community_service.category_id = community_service_category.id \
	LEFT JOIN open_service_detail ON open_caution_info.service_id = open_service_detail.service_id \
where \$CONDITIONS AND open_caution_info.create_time < '$todayStr'"